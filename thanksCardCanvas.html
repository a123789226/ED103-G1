<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <title>Thanks Card</title>
    <style>
      canvas {
  border: 1px solid #000;
}
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
body {
  position: relative;
}


input[type="file"] {
  display: none;
}

img {
  display: inline-block;
  border: 1px solid #eaeaea;
  height: 100px;
  width: 100px;
}

[draggable] {
    -moz-user-select: none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    user-select: none;
    -khtml-user-drag: element;
    -webkit-user-drag: element;
    cursor: move;
}
    </style>
</head>
<body>
  <!-- 下面是背景的div，先不要動到 -->
  <div class="ticketBG">
    <div class="commonBG00 commonBGSet"></div>
    <div class="commonBG01 commonBGSet"></div>
    <div class="commonBG02 commonBGSet"></div>
    <div class="commonBGLeft commonBGSet"></div>
    <div class="commonBGRight commonBGSet"></div>
    <img src="./image/background/fish1.png" alt="" class="BGFish1">
    <img src="./image/background/fish1.png" alt="" class="BGFish2">
  </div> 
  <!-- 上面是背景的div，先不要動到 -->
 
  <!-- Log In開始 -->
  <div id="memLightBox" class="memLogin overlay">
    <form action="" class="LogInForm" id="LogInForm" method="post">
      <div class="btn_modal_close">
        <div></div>
        <div></div>
      </div>
      <h3 class="memLogTitle">LOG IN</h3>
      <input type="text" name="memId" id="memId" minlength="6" maxlength="12" pattern="[A-Za-z0-9]*" placeholder="Username" onfocus="this.placeholder=''" onblur="this.placeholder='Username'" size="25"/><br>
      <input type="password" name="memPsw" id="memPsw" minlength="6" maxlength="12" pattern="[A-Za-z0-9]*" placeholder="Password" onfocus="this.placeholder=''" onblur="this.placeholder='Password'" size="25"/><br>
      <h6><a href="./memberLock.html" class="memForgot memForget_modal">Forget Password?</a></h6><br>
      <input type="button" class="submitBtnLog" id="btnLogin" value="LOG IN"><br>
      <div class="memLine">
        <h5>OR</h5>
      </div>
      <p>Don't have an account?</p><br>
      <a href="./memberlogin.html"><button type="button" class="submitBtnSign" id="btnSignup">SIGN UP</button></a>
    </form>
  </div>
  <!-- Log In結束 -->
  
  <!-- header開始 -->
  <header class="main_menu">
    <!-- header第一區塊 主導覽列 -->
    <nav class="main_nav">
      <div class="logo_box">
        <a href="homepage.html" class="logo">
          <img src="./image/header/logo.png" alt="">
        </a>
        <a href="" class="logo_text_box">
          <h1 class="logo_text">AQUA WONDERLAND</h1>
        </a>
      </div>
      <ul class="main_menu_ul" id="main_menu_ul">
        <li class="main_menu_li active">
          <a href="tour.html" class="li_logo">
            <img src="./image/header/header_tour.png" alt="">
            <img src="./image/header/header_tour_cover.png" alt="">
          </a>
          <a href="tour.html" class="li_text">TOUR</a>
        </li>
        <li class="main_menu_li active">
          <a href="journal.html" class="li_logo">
            <img src="./image/header/header_journal.png" alt="">
            <img src="./image/header/header_journal_cover.png" alt="">
          </a>
          <a href="journal.html" class="li_text">JOURNAL</a>
        </li>
        <li class="main_menu_li active">
          <a href="ticket.html" class="li_logo">
            <img src="./image/header/header_ticket.png" alt="">
            <img src="./image/header/header_ticket_cover.png" alt="">
          </a>
          <a href="ticket.html" class="li_text">TICKET</a>
        </li>
        <li class="main_menu_li active">
          <a href="vote.html" class="li_logo">
            <img src="./image/header/header_vote.png" alt="">
            <img src="./image/header/header_vote_cover.png" alt="">
          </a>
          <a href="vote.html" class="li_text">VOTE</a>
        </li>
        <li class="main_menu_li active">
          <a href="blog1.php" class="li_logo">
            <img src="./image/header/header_blog.png" alt="">
            <img src="./image/header/header_blog_cover.png" alt="">
          </a>
          <a href="blog1.php" class="li_text">BLOG</a>
        </li>
      </ul>
      <div class="header_right">
        <span class="member_box btn_modal" id="btn_modal">
          <img src="./image/header/header_member_fish.png" alt="" title="Log In" id="memberPic" onerror="javascript:this.src='./image/header/header_member_fish_login.png'">
        </span>
        <a class="cart_box" href="cart.html">
          <img src="./image/header/header_cart.png" alt="">
          <span class="cart_amount"></span>
        </a>
        <div class="hamburger_box" id="hamburger_box">
          <div class="hamburger">
            <span class="hamburger_line is-active" id="hamburger_line"></span>
            <span class="hamburger_cross" id="hamburger_cross">&times;</span>
          </div>
        </div>
      </div>
    </nav>
    
    <!-- header第二區塊 會員登入後點頭像出線的小窗 -->
    <div class="memProfileBlock" id="memProfileBlock" style="display: none;">
      <p class="memNameInProfileBlock"><span>Hello!&nbsp;&nbsp;</span><span id="memNameInProfileBlock"></span></p>
      <a href="./memberProfile.html" class="memProfileLink">Member Profile</a>
      <p id="SignOutLink">Sign Out</p>
    </div>

  </header> 

  <!-- header結束 -->


<div>
    <div class="commonTitleBox">
      <h2 class="commonTitle">Thanks Card</h2>
      <h4 class="commonSubTitle">Thank you for adopting aqua in Aqua Wonderland; you can make your own unique Thanks Card by yourself.</h4>
    </div>

<!-- 你的code打這下面 -->



<div class="options">
  <button id="imageUploader" >上傳</button>
  <input type="file" id="file">
</div>
拖曳圖片
<div id="imgset">
<img id="defaultImg" src="https://www.pakutaso.com/shared/img/thumb/neko1869IMG_9074_TP_V.jpg" alt="" draggable>
 <img src="https://picsum.photos/200/300?random=2">
 <img src="https://picsum.photos/200/300?random=6">
 <img class="cardBgc" src="./image/thanksCard/background1.png" alt="">
 <img class="cardBgc" src="./image/thanksCard/background2.png" alt="">
 <img class="cardBgc" src="./image/thanksCard/background3.png" alt="">
 <img class="cardAnimals" src="./image/thanksCard/animal1.png" alt="">
 <img class="cardAnimals" src="./image/thanksCard/animal2.png" alt="">
 <img class="cardAnimals" src="./image/thanksCard/animal3.png" alt="">
 <img class="cardDeco" src="./image/thanksCard/deco1.png" alt="">
            <img class="cardDeco" src="./image/thanksCard/deco2.png" alt="">
            <img class="cardDeco" src="./image/thanksCard/deco3.png" alt="">
   
</div>
<div class="cardMaterials">
        
<canvas id="canvas"></canvas>


<div class="cardContainer">
    <div class="cardMaterials">
        <div class="cardMaterialBackground step active">
          <p>Select your background.</p>
          <img class="cardBgc" src="./image/thanksCard/background1.png" alt="">
          <img class="cardBgc" src="./image/thanksCard/background2.png" alt="">
          <img class="cardBgc" src="./image/thanksCard/background3.png" alt="">
        </div>
        <div class="cardMaterialAnimal step">
            <p>Select your favorite animal.</p>
            <img class="cardAnimals" src="./image/thanksCard/animal1.png" alt="">
            <img class="cardAnimals" src="./image/thanksCard/animal2.png" alt="">
            <img class="cardAnimals" src="./image/thanksCard/animal3.png" alt="">
              
        </div>
        <div class="cardMaterialDeco step">
            <p>Select your decorations.</p>
            <img class="cardDeco" src="./image/thanksCard/deco1.png" alt="">
            <img class="cardDeco" src="./image/thanksCard/deco2.png" alt="">
            <img class="cardDeco" src="./image/thanksCard/deco3.png" alt="">
        </div>
        <div class="cardBtnSection">
          <button class="btn50whiteA" id="prev" disabled="disabled">BACK</button>
          <button class="btn50whiteA" id="next">NEXT</button>
        </div>
    </div>

    <!-- 圖片位置 -->
    <div class="cardSectionContainer"  id="chart3">
        <div class="cardSectionContent">
          <div class="cardSelectText">
            <p>Thank you for your donation,<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wish you have a beautiful day!
            </p>
            </div>
            <div class="cardSelectAnimal"></div>
            <div class="cardAnimalChosen"></div>
            <div class="cardDecoChosen"></div>
            
            </div>
            <!-- <div class="cardSelectDeco" style="background-image: url(https://picsum.photos/300/200?random=89);"></div>></div> -->
          </div>

        </div>
    </div>
</div>
<a href="#" id="a" download>點選下載圖片</a>


<!--Sign In-->
  <div class="memLogin overlay">
    <form class="LogInForm" id="LogInForm" method="post">
      <div class="btn_modal_close">
        <div></div>
        <div></div>
      </div>
      <h3 class="memLogTitle">LOG IN</h3>
      <input type="text" name="memId" id="memId" minlength="8" maxlength="12" pattern="[A-Za-z0-9]*" placeholder="Username" size="35"/><br>
      <input type="password" name="memPsw" id="memPsw" minlength="8" maxlength="12" pattern="[A-Za-z0-9]*" placeholder="Password" size="35"/><br>
      <h6><a href="./memberLock.html" class="memForgot memForget_modal">Forget Password?</a></h6><br>
      <button type="button" class="submitBtnLog" id="btnLogin">LOG IN</button><br>
      <div class="memLine">
        <h5>OR</h5>
      </div>
      <p>Don't have an account?</p><br>
      <a href="./memberlogin.html"><button type="button" class="submitBtnSign" id="btnSignup">SIGN UP</button></a>
    </form>
  </div>










  <footer>
    Copyright 2020 ED103-G1 Aqua Wonderland All Rights Reserved
  </footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

  <script>



    // jQuery
    //漢堡
    $("div.hamburger_box").on("click", function(){
      $("span.hamburger_line").toggleClass("is-active");
      $("span.hamburger_cross").toggleClass("is-active");
      $("ul.main_menu_ul").toggleClass("is-active");
    });

  // Login彈窗
  $(function(){
    // 開啟 Modal 彈跳視窗
    $("a.btn_modal").on("click", function(){
      $("div.overlay").addClass("-on");
    });
    // 關閉 Modal
    $("div.btn_modal_close").on("click", function(){
      $("div.overlay").addClass("-opacity-zero");
      // 設定隔一秒後，移除相關 class
      setTimeout(function(){
        $("div.overlay").removeClass("-on -opacity-zero");
      }, 1000);
    });
  });


// 上一步下一步按鈕控制css的display
  var index = $(".step.active").index(".step"), 
    stepsCount = $(".step").length, 
    prevBtn = $("#prev"), 
    nextBtn = $("#next"); 

// 上一步
prevBtn.click(function() { 
    nextBtn.prop("disabled", false); 

    if (index > 0) { 
     index--; 
     $(".step").removeClass("active").eq(index).addClass("active"); 
    }; 

    if (index === 0) { 
     $(this).prop("disabled", true); 
    } 
}); 

// 下一步
nextBtn.click(function() { 
    prevBtn.prop("disabled", false); 

    if (index < stepsCount - 1) { 
     index++; 
     $(".step").removeClass("active").eq(index).addClass("active"); 
    }; 

    if (index === stepsCount - 1) { 
     $(this).prop("disabled", true); 
    } 
}); 






var temp = 0;
// 換背景
$(document).ready(function(){
    let img = $('.cardBgc');
    console.log(img);
    for (let i = 0; i < img.length; i++) {
        img[i].addEventListener('click',changeBgPattern1)
    console.log(img);

    }
    
});
function changeBgPattern1(){
    imgSrc = $(this).attr('src');
    if(temp == 0){
        $('.cardSectionContent').css('backgroundImage', `url(${imgSrc})`);
    }
}

// 換動物圖
$(document).ready(function(){
    let img = $('.cardAnimals');
    for (let i = 0; i < img.length; i++) {
        img[i].addEventListener('click',changeBgPattern2)
    // console.log(img);
    }
});
function changeBgPattern2(){
    imgSrc = $(this).attr('src');
    if(temp == 0){
        $('.cardAnimalChosen').css('backgroundImage', `url(${imgSrc})`);
    }
}

//換裝飾品
$(document).ready(function(){
    let img = $('.cardDeco');
    console.log(img);
    for (let i = 0; i < img.length; i++) {
        img[i].addEventListener('click',changeBgPattern3)
    console.log(img);

    }
    
});
function changeBgPattern3(){
    imgSrc = $(this).attr('src');
    if(temp == 0){
        $('.cardDecoChosen').css('backgroundImage', `url(${imgSrc})`);
    }
}


  </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/2.1.0/fabric.min.js"></script>
<script>
  const canvas = new fabric.Canvas('canvas', {
  width: 500,
  height: 500
})

const $ = (id) => document.getElementById(id)
const imageUploader = $('imageUploader')
const file = $('file')
const imgset = $('imgset')
const defaultImg = $('defaultImg')
let movingImage
let imgDragOffset = {
  offsetX: 0,
  offsetY: 0
}
function uploadFile (e) {
  file.click()
}

function saveImg (e) {
  if( e.target.tagName.toLowerCase() === 'img' ){
    imgDragOffset.offsetX = e.clientX - e.target.offsetLeft
    imgDragOffset.offsetY = e.clientY - e.target.offsetTop
    movingImage = e.target
  }
}

function handleFile () {
  const fileReader = new FileReader();
  fileReader.readAsDataURL(this.files[0])
  fileReader.onload = (e) => {
    // 圖片 base64
    const dataURL = e.target.result
    const img = document.createElement('img')
    img.draggable = true
    img.src = dataURL
    img.click = saveImg
    imgset.appendChild(img)
  }
}

function dropImg (e) {
  const {offsetX, offsetY} = e.e
  const image = new fabric.Image(movingImage, {
    width: movingImage.naturalWidth,
    height: movingImage.naturalHeight,
    scaleX: 100 / movingImage.naturalWidth,
    scaleY: 100 / movingImage.naturalHeight,
    top: offsetY - imgDragOffset.offsetY,
    left: offsetX - imgDragOffset.offsetX
  })
  canvas.add(image)
}

imageUploader.addEventListener('click', uploadFile, true)
file.addEventListener('change', handleFile)
canvas.on('drop', dropImg)

// defaultImg.addEventListener('mousedown', saveImg)
imgset.addEventListener('mousedown', saveImg)


</script>
  <script src="./js/memLogin.js"></script>
  <script src="./js/layout/header.js"></script>
</body>
</html>